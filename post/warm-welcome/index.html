<!DOCTYPE html>
<html lang="en">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.83.1" />


<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dsrkafuu/dsr-cdn-main@1/images/favicons/dsrca.ico" />



<title>Warm Welcome - Sudoeruser</title>


<meta name="author" content="Sudoeruser" />


<meta name="description" content="Solution of WarmWelcome" />



<meta property="og:title" content="Warm Welcome" />
<meta name="twitter:title" content="Warm Welcome" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sudoeruser.github.io/post/warm-welcome/" /><meta property="og:description" content="Solution of WarmWelcome" />
<meta name="twitter:description" content="Solution of WarmWelcome" /><meta name="twitter:card" content="summary" /><meta property="article:published_time" content="2021-06-11T14:44:35+04:30" /><meta property="article:modified_time" content="2021-06-11T14:44:35+04:30" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>




<link rel="stylesheet" href="https://sudoeruser.github.io/assets/css/fuji.min.css" />








</head>

<body
  data-theme="auto"
  data-theme-auto='true'
  >
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>

    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://sudoeruser.github.io">Sudoeruser</a>
            
            <span class="title-sub">My Notes About Computer &amp; Cyber Security.</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://sudoeruser.github.io/post/warm-welcome/">Warm Welcome</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-06-11</span>

<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;879 words</span>

<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;No tag</span>

    </div>
    
    <div class="post-content markdown-body">
        <p>in this Post we Going to checkout the WarmWelcome Challenge in S4CTF(Peykar).</p>
<p>Category:Reverse</p>
<h2 id="solution">Solution</h2>
<p>for first step, i opened the program in <strong>r2</strong> and carefully examined the main function.</p>
<pre><code class="language-â€Œ">
[0x0000139f]&gt; pdgo
    0x0000139f    |undefined8
    0x0000139f    |main(undefined8 param_1, undefined8 param_2, undefined8 param_3, undefined8 param_4, undefined8 param_5,
                  |    undefined8 param_6, undefined8 param_7, undefined8 param_8)
                  |{
                  |    undefined4 uVar1;
                  |    int32_t iVar2;
                  |    double placeholder_1;
                  |    char var_8bh [2];
                  |    char *s;
                  |    char *buf;
                  |    char var_78h;
                  |    int32_t iStack127;
                  |    int32_t iStack123;
                  |    int64_t var_6fh;
                  |    int32_t iStack100;
                  |    char var_58h;
                  |    char var_57h;
                  |    int64_t var_56h;
                  |    char var_4eh;
                  |    int64_t var_4dh;
                  |    undefined8 req;
                  |    int64_t var_38h;
                  |    undefined8 var_28h;
                  |    undefined8 var_20h;
                  |    undefined8 var_18h;
                  |    int64_t ptr;
                  |    undefined8 size;
                  |    
    0x000013aa    |    req = 0;
    0x000013b2    |    var_38h = 25000000;
    0x000013ba    |    size = 200;
    0x000013c7    |    sym.ncurses_init();
    0x000013d1    |    uVar1 = sym.imp.time(0);
    0x000013d8    |    sym.imp.srand(uVar1);
    0x000013e9    |    ptr = sym.imp.calloc(0x20, size);
    0x000013fe    |    var_18h = sym.imp.calloc(0x20, size);
    0x00001413    |    var_20h = sym.imp.calloc(0x20, size);
    0x00001428    |    var_28h = sym.imp.calloc(0x20, size);
    0x0000143f    |    sym.particle_init(ptr, size);
    0x00001452    |    sym.particle_init(var_18h, size);
    0x00001465    |    sym.particle_init(var_20h, size);
    0x00001478    |    sym.particle_init(var_28h, size);
    0x00001681    |    while (iVar2 = sym.imp.wgetch(_reloc.stdscr), iVar2 != 0x71) {
    0x0000148b    |        placeholder_1 = (double)*(float *)(ptr + 0x18);
    0x000014b2    |        if ((*(double *)0x20a8 &lt;= placeholder_1) || ((double)*(float *)(ptr + 0x18) &lt;= *(double *)0x20b0)) {
    0x000014d5    |            placeholder_1 = (double)*(float *)(ptr + 0x18);
    0x000014fc    |            if ((*(double *)0x20b8 &lt;= placeholder_1) || ((double)*(float *)(ptr + 0x18) &lt;= *(double *)0x20c0)) {
    0x0000151c    |                placeholder_1 = (double)*(float *)(ptr + 0x18);
    0x00001543    |                if ((*(double *)0x20c8 &lt;= placeholder_1) || ((double)*(float *)(ptr + 0x18) &lt;= *(double *)0x20d0)) {
    0x00001563    |                    placeholder_1 = (double)*(float *)(ptr + 0x18);
    0x00001573    |                    if (placeholder_1 &lt; *(double *)0x20d8) {
    0x00001583    |                        sym.particle_init(ptr, size);
                  |                    }
                  |                } else {
    0x00001553    |                    sym.particle_init(var_28h, size);
                  |                }
                  |            } else {
    0x0000150c    |                sym.particle_init(var_20h, size);
                  |            }
                  |        } else {
    0x000014c2    |            sym.particle_init(var_18h, size);
                  |        }
    0x00001592    |        sym.imp.werase(_reloc.stdscr);
    0x000015a2    |        sym.particle_update((uint64_t)*(uint32_t *)0x20e0, placeholder_1, param_3, param_4, param_5, param_6, param_7, 
    0x000015ad    |                            param_8, ptr, size);
    0x000015bd    |        sym.particle_update((uint64_t)*(uint32_t *)0x20e0, placeholder_1, param_3, param_4, param_5, param_6, param_7, 
    0x000015c8    |                            param_8, var_18h, size);
    0x000015d8    |        sym.particle_update((uint64_t)*(uint32_t *)0x20e0, placeholder_1, param_3, param_4, param_5, param_6, param_7, 
    0x000015e3    |                            param_8, var_20h, size);
    0x000015f3    |        sym.particle_update((uint64_t)*(uint32_t *)0x20e0, placeholder_1, param_3, param_4, param_5, param_6, param_7, 
    0x000015fe    |                            param_8, var_28h, size);
    0x00001611    |        sym.particle_draw(ptr, size);
    0x00001624    |        sym.particle_draw(var_18h, size);
    0x00001637    |        sym.particle_draw(var_20h, size);
    0x0000164a    |        sym.particle_draw(var_28h, size);
    0x00001659    |        sym.imp.wrefresh(_reloc.stdscr);
    0x0000165e    |        sym.imp.nanosleep(&amp;req, 0);
                  |    }
    0x0000168e    |    sym.imp.free(ptr);
    0x00001693    |    ptr = 0;
    0x000016a2    |    sym.imp.free(var_18h);
    0x000016a7    |    var_18h = 0;
    0x000016b6    |    sym.imp.free(var_20h);
    0x000016bb    |    var_20h = 0;
    0x000016ca    |    sym.imp.free(var_28h);
    0x000016cf    |    var_28h = 0;
    0x000016d7    |    sym.imp.endwin();
    0x000016e3    |    sym.imp.puts(&quot;Hope you enjoy the firework we prepared for you! Now give me a flag :))\n&quot;);
    0x000016f9    |    sym.imp.read(0, &amp;buf, 0x34);
    0x000016fe    |    sym.imp.sprintf(&amp;s, 0x2051, 4);
    0x00001739    |    sym.imp.sprintf(var_8bh, 0x2051, 0);
    0x0000173e    |    s._2_1_ = 0x54;
    0x00001745    |    s._3_1_ = 0x68;
    0x0000174c    |    s._4_1_ = 0x33;
    0x00001753    |    s._5_1_ = 0x5f;
    0x0000175a    |    s._6_1_ = 0x46;
    0x00001761    |    s._7_1_ = 0x31;
    0x0000189e    |    if (((((((((char)buf == 'S') &amp;&amp; (buf._1_1_ == '4')) &amp;&amp; (buf._2_1_ == 'C')) &amp;&amp;
    0x00001790    |           ((buf._3_1_ == 'T' &amp;&amp; (buf._4_1_ == 'F')))) &amp;&amp; (buf._5_1_ == '{')) &amp;&amp;
    0x000017b4    |         ((((char)var_4dh == '}' &amp;&amp;
    0x000017d3    |           (iVar2 = sym.imp.strncmp((int64_t)&amp;var_6fh + 1, &quot;We1c0m3_fr0m_S4LAB&quot;, 0x12), iVar2 == 0)) &amp;&amp;
    0x000017e4    |          ((buf._6_1_ == 'A' &amp;&amp; (((buf._7_1_ == '_' &amp;&amp; (var_78h == 'v')) &amp;&amp; (iStack123 == 0x6d726157)))))))) &amp;&amp;
    0x00001833    |        ((iVar2 = sym.imp.strncmp((int64_t)&amp;var_56h + 1, (int64_t)&amp;s + 2, 6, (int64_t)&amp;s + 2), iVar2 == 0 &amp;&amp;
    0x00001846    |         (iStack100 == 0x6a6e655f)))) &amp;&amp;
    0x00001857    |       ((iStack127 == 0x5f797233 &amp;&amp;
    0x00001866    |        ((((char)var_6fh == (char)var_56h &amp;&amp; ((char)var_6fh == '_')) &amp;&amp;
    0x00001876    |         ((var_4eh == 'g' &amp;&amp; (((var_57h == 'y' &amp;&amp; (var_56h._7_1_ == (char)s)) &amp;&amp; (var_58h == var_8bh[0])))))))))) {
    0x000018a7    |        sym.imp.puts(&quot;\rOh Wow you are ready for fun!! :)\n&quot;);
    0x000018c5    |        return 0;
                  |    }
    0x000018ba    |    sym.imp.puts(&quot;Try harder to have fun!!\n&quot;);
    0x000018c5    |    return 0;
                  |}

[0x0000139f]&gt; 

</code></pre>
<p>As you can see, at the beginning of the program we have a loop that is most likely related to the fireworks display. To easily debug the program, we can disable it by Rewrite <strong>JMP</strong> Instruction in <strong>0x0000147d</strong> address. In the following program code, the expressions printed by the <strong>puts</strong> function. also we can see <strong>read</strong> Syscall , that takes input from the user and store it in stack.</p>
<p>and finally , program have a condition and this is all of the problem :D . so let&rsquo;s go to set BreakPoint on conditions. The points required to set the BreakPoints are between <strong>0x0000176c</strong> and <strong>0x0000189c</strong>.
now we ready to start debugging. For Start we most have a Specific string.I used all uppercase and lowercase letters to recognize the results. <code>abcdefghijklmnopqrstuvwxjzABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p>in debugging process , we check values and replace it with our string letters. For convenience, you can use the following code to store data:</p>
<pre><code class="language-python">
#!/usr/bin/python3
deff =  {}

def  main():
	checker =  &quot;&quot;
	letters =  &quot;abcdefghijklmnopqrstuvwxjzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;
	for i in letters:
		deff[i]  =  hex(ord(i)).replace(&quot;0x&quot;,&quot;&quot;)
	while  True:
		checker =  input(&quot;Enter letter to set value :&gt;&gt; &quot;)
		if checker ==  &quot;EXIT&quot;:
                    break
		value =  input(&quot;Enter Value :&gt;&gt; &quot;)
		deff[checker]  = value
	for i in letters:
            print(deff[i],end=&quot;&quot;)

  
  

if  __name__  ==  &quot;__main__&quot;:
    main()

</code></pre>
<p>and finally we got the flag :D  &raquo; <code>S4CTF{A_v3ry_Warm_We1c0m3_fr0m_S4LAB_enj0y_Th3_F14g}</code></p>
    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a>.</p>
    </blockquote>
</div>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/sudoeruser" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://twitter.com/sudoeruser" target="_blank"><span>Twitter</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#solution">Solution</a></li>
  </ul>
</nav></div>
</aside>

        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/sudoeruser" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://twitter.com/sudoeruser" target="_blank"><span>Twitter</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#solution">Solution</a></li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2020-2021
                <a href="https://sudoeruser.github.io">Sudoeruser</a>
                 | <a href="https://github.com/dsrkafuu/hugo-theme-fuji">Source code</a> 
                | Powered by <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>



</body>

</html>
